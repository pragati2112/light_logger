<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<div id="app">
    <p style=" font-size: 3rem; text-align: center;">{{ message }}</p>
    <br>
    <div style="text-align: center; ">
        <button type="button" style="padding: 0.7rem;
            align-content: center"
            @click="fetchLogs">Start streaming
        </button>
    </div>

    <div id="messages"></div>

</div>

<script>
  const { createApp } = Vue

  createApp({
    data() {
      return {
        message: 'Hello light logger!',
        connection: null
      }
    },

    created: function() {
        console.log("Starting connection to WebSocket Server")
        this.connection = new WebSocket("ws://127.0.0.1:8001/ws")

        this.connection.onmessage = function(event) {
            let messages = document.getElementById('messages')
            let message = document.createElement('li')
            let content = document.createTextNode(event.data)
            message.appendChild(content)
            messages.appendChild(message)
        }

        this.connection.onopen = function(event) {
          console.log(event)
          console.log("Successfully connected to the echo websocket server...")
        }
    },

    methods:{
        fetchLogs: function (){
            let data = {
                start_date:'',
                end_date:'',
                per_page:50
            }
            this.connection.send(JSON.stringify(data))
        }
    }


  }).mount('#app')
</script>

<style>
    body{
        background-color: rgb(236, 236, 236);
        width: 100%;
        height: 100%;
    }
</style>
